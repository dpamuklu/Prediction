<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <title>Predictions</title>
  </head>

  <body>
    <div class="container-fluid">

      <div class="header">
        <h3>
          Daily Prediction: <%= predict_date %>
        </h3>
      </div>

      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Home Team</th>
              <th scope="col">Away Team</th>
              <th scope="col">Prediction</th>
              <th scope="col">Odd</th>
              <th scope="col">Time</th>
            </tr>
          </thead>
          <tbody>
            <% var isodate = new Date().toISOString() %>
            <% result.prediction.forEach(function(prediction){ %>
              <!-- sort by date -->
              <% prediction.body.data.sort(function(a, b) {
                   return (a.start_date < b.start_date ) ? -1 : ((a.start_date > b.start_date) ? 1 : 0);
              }); %>

              <% prediction.body.data.forEach(function(detail){ %>
                <% var odd = detail.prediction %>
                <% var gameDate = detail.start_date %>
                <% var date = detail.start_date.split("T")[1]; %>

                <tr>
                  <td><%= detail.home_team %></td>
                  <td><%= detail.away_team %></td>
                  <td><%= detail.prediction %></td>

                  <!-- check bet is greater than 1.5 -->
                  <% if (detail.odds[odd] > 1.6 ) { %>
                    <td class="text-danger"><%= detail.odds[odd] %></td>
                  <% } else if ( detail.odds[odd] < 1.6 && detail.odds[odd] > 1.25 ) { %>
                    <td class="text-primary"><%= detail.odds[odd] %></td>
                  <% } else { %>
                    <td><%= detail.odds[odd] %></td>
                  <% } %>

                  <!-- check bet is still active  -->
                  <% if (isodate > gameDate ) { %>
                    <td class="text-danger"><%= date %> </td>
                  <% } else { %>
                  <td><%= date %> </td>
                  <% } %>
                </tr>

              <% }) %>
            <% }) %>
          </tbody>
        </table>
      </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

  </body>

</html>
